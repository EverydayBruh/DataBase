# НИЯУ МИФИ. Лабораторная работа №2. Журбенко Василий, Б21-525. 2024

## SQL сценарии
1. [Инициализация](./scripts/1_init_db.sql)
2. [Заполнение](./scripts/2_insert_db.sql)
3. [Select-запросы](./scripts/3_select.sql)

## Запросы и результаты

### 1. Полная выборка всех товаров
```sql
SELECT * FROM products;
```
<details>
  <summary>Результаты</summary>

| id | name                  | description                     | purchase_price | sale_price | supplier_id |
|----|-----------------------|---------------------------------|----------------|------------|-------------|
| 1  | Золотое кольцо        | Кольцо из золота 585 пробы      | 20000.0        | 25000.0    | 1           |
| 2  | Серебряная цепочка    | Цепочка из серебра 925 пробы    | 5000.0         | 7000.0     | 2           |
| 3  | Бриллиантовый браслет | Браслет с бриллиантами          | 50000.0        | 65000.0    | 1           |
| 4  | Жемчужные серьги      | Серьги с жемчугом               | 12000.0        | 18000.0    | 2           |
| 5  | Изумрудное колье      | Колье с изумрудами              | 80000.0        | 120000.0   | 1           |

</details>

### 2. Условная выборка товаров с ценой продажи более 10000
```sql
SELECT * FROM products WHERE sale_price > 10000;
```
<details>
  <summary>Результаты</summary>

| id | name                  | description                     | purchase_price | sale_price | supplier_id |
|----|-----------------------|---------------------------------|----------------|------------|-------------|
| 1  | Золотое кольцо        | Кольцо из золота 585 пробы      | 20000.0        | 25000.0    | 1           |
| 3  | Бриллиантовый браслет | Браслет с бриллиантами          | 50000.0        | 65000.0    | 1           |
| 4  | Жемчужные серьги      | Серьги с жемчугом               | 12000.0        | 18000.0    | 2           |
| 5  | Изумрудное колье      | Колье с изумрудами              | 80000.0        | 120000.0   | 1           |

</details>

### 3. Упорядоченная выборка всех продавцов по фамилии в порядке возрастания
```sql
SELECT * FROM sellers ORDER BY last_name;
```
<details>
  <summary>Результаты</summary>

| id | first_name | last_name | department_id |
|----|------------|-----------|---------------|
| 1  | Иван       | Иванов    | 1             |
| 4  | Ольга      | Павлова   | 1             |
| 2  | Петр       | Петров    | 2             |
| 3  | Сергей     | Сергеев   | 3             |
| 5  | Андрей     | Соколов   | 2             |

</details>

### 4. Выборка товаров с вычислением разницы между ценой продажи и ценой закупки
```sql
SELECT name, (sale_price - purchase_price) AS profit FROM products;
```
<details>
  <summary>Результаты</summary>

| name                  | profit  |
|-----------------------|---------|
| Золотое кольцо        | 5000.0  |
| Серебряная цепочка    | 2000.0  |
| Бриллиантовый браслет | 15000.0 |
| Жемчужные серьги      | 6000.0  |
| Изумрудное колье      | 40000.0 |

</details>

### 5. Подсчёт количества продаж для каждого товара и упорядочивание по количеству в убывающем порядке
```sql
SELECT product_id, COUNT(*) AS sale_count FROM sales GROUP BY product_id ORDER BY sale_count DESC;
```
<details>
  <summary>Результаты</summary>

| product_id | sale_count |
|------------|------------|
| 5          | 2          |
| 3          | 2          |
| 2          | 2          |
| 1          | 2          |
| 4          | 1          |

</details>

### 6. Выборка уникальных локаций отделов
```sql
SELECT DISTINCT location FROM departments;
```
<details>
  <summary>Результаты</summary>

| location                            |
|-------------------------------------|
| Москва, ул. Арбат, 15               |
| Москва, ул. Варшавское шоссе, 37    |
| Москва, ул. Тверская, 25            |

</details>

### 7. Подсчёт общего количества товаров в каждом отделе
```sql
SELECT department_id, SUM(quantity) AS total_quantity FROM inventory GROUP BY department_id;
```
<details>
  <summary>Результаты</summary>

| department_id | total_quantity |
|---------------|----------------|
| 1             | 33             |
| 2             | 29             |
| 3             | 19             |

</details>

### 8. Выборка продавцов и количества их продаж, упорядоченная по количеству продаж в порядке убывания
```sql
SELECT s.first_name, s.last_name, COUNT(sa.id) AS sales_count FROM sellers s
JOIN sales sa ON s.id = sa.seller_id
GROUP BY s.id, s.first_name, s.last_name
ORDER BY sales_count DESC;
```
<details>
  <summary>Результаты</summary>

| first_name | last_name | sales_count |
|------------|-----------|-------------|
| Иван       | Иванов    | 2           |
| Петр       | Петров    | 2           |
| Сергей     | Сергеев   | 2           |
| Ольга      | Павлова   | 2           |
| Андрей     | Соколов   | 1           |

</details>

## Заключение

В ходе данной работы было проведено наполнение таблиц случайными данными для последующей выборки данных. Для выборки данных были выполнены 8 различных SQL запросов, имитирующих взаимодействие с базой данных сети ювелирных магазинов.